<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="&#34;auto&#34;"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/longblog/static/img/favicon.png"><link rel="icon" href="/longblog/static/img/favicon.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="description" content=""><meta name="author" content="longalong"><meta name="keywords" content=""><title>批任务处理工具 - Longbao</title><link rel="stylesheet" href="https://static.longalong.cn/packages/blog/css/bootstrap.min.css"><link rel="stylesheet" href="https://static.longalong.cn/packages/blog/github-markdown.min.css"><link rel="stylesheet" href="/longblog/lib/hint/hint.min.css"><link rel="stylesheet" href="https://static.longalong.cn/packages/blog/styles/github-gist.min.css"><link rel="stylesheet" href="https://static.longalong.cn/packages/blog/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css"><link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css"><link rel="stylesheet" href="/longblog/css/main.css"><script id="fluid-configs">var Fluid=window.Fluid||{},CONFIG={hostname:"iamlongalong.github.io",root:"/longblog/",version:"1.8.11",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"right",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},copy_btn:!0,image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/static/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,baidu:null,google:null,gtag:null,tencent:{sid:null,cid:null},woyaola:null,cnzz:null,leancloud:{app_id:null,app_key:null,server_url:null}},search_path:"/local-search.xml"}</script><script src="/longblog/js/utils.js"></script><script src="/longblog/js/color-schema.js"></script><meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/longblog/rss.xml" title="Longbao" type="application/atom+xml">
</head><body><header style="height:35vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/longblog/">&nbsp;<strong>Longbao</strong>&nbsp;</a> <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/longblog/"><i class="iconfont icon-home-fill"></i> 首页</a></li><li class="nav-item"><a class="nav-link" href="/longblog/archives/"><i class="iconfont icon-archive-fill"></i> 归档</a></li><li class="nav-item"><a class="nav-link" href="/longblog/categories/"><i class="iconfont icon-category-fill"></i> 分类</a></li><li class="nav-item"><a class="nav-link" href="/longblog/tags/"><i class="iconfont icon-tags-fill"></i> 标签</a></li><li class="nav-item"><a class="nav-link" href="/longblog/about/"><i class="iconfont icon-user-fill"></i> 关于</a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" data-toggle="modal" data-target="#modalSearch">&nbsp;<i class="iconfont icon-search"></i>&nbsp;</a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self">&nbsp;<i class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a></li></ul></div></div></nav><div class="banner" id="banner" parallax="true" style="background:url(/longblog/static/img/default.jpg) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="page-header text-center fade-in-up"><span class="h2" id="subtitle" title="批任务处理工具"></span><div class="mt-3"><span class="post-meta mr-2"><i class="iconfont icon-author" aria-hidden="true"></i> longalong </span><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2022-11-23 01:26" pubdate>2022年11月23日 凌晨</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 4.8k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 66 分钟</span></div></div><div class="scroll-down-bar"><i class="iconfont icon-arrowdown"></i></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div class="py-5" id="board"><article class="post-content mx-auto"><h1 style="display:none">批任务处理工具</h1><div class="markdown-body"><h2 id="shell"><a href="#shell" class="headerlink" title="shell"></a>shell</h2><h3 id="基本认识"><a href="#基本认识" class="headerlink" title="基本认识"></a>基本认识</h3><p>shell 是一个用于和 linux 内核交互的工具，通常用来编写各种自动化脚本。</p><p>shell 有两种模式，交互式 和 脚本式，我们主要谈论脚本式。</p><p>shell 很强大，我认为强大来源于三方面：</p><ul><li>脚本语言，开发方便</li><li>环境适应性非常非常广</li><li>能够粘合各类工具</li></ul><p>shell 也有一些问题，我认为主要在这两方面：</p><ul><li>编程范式和现代高级语言有较大差异 (几乎是纯命令式编程，且语言风格与其他语言差别较大)</li><li>语言本身的功能较弱，工程能力较差 (缺乏统一标准库、模块管理能力弱)</li></ul><p>现在大多数机器中都集成了 python，因此基于 python 在很多场景下是可以替代 shell 的，尤其是在十分需要 <code>工程化</code> 的项目中。</p><p>但由于 shell 和 linux 系统有着天生的兼容性，因此 shell 一定会大量运用于 linux 中的各个方面，甚至可以认为: **linux 不灭，shell 永存 **。</p><h3 id="shell-主要难理解的地方"><a href="#shell-主要难理解的地方" class="headerlink" title="shell 主要难理解的地方"></a>shell 主要难理解的地方</h3><h4 id="变量的差异"><a href="#变量的差异" class="headerlink" title="变量的差异"></a>变量的差异</h4><h5 id="类型系统是非常非常弱的！！"><a href="#类型系统是非常非常弱的！！" class="headerlink" title="类型系统是非常非常弱的！！"></a>类型系统是非常非常弱的！！</h5><p>在 shell 中，字面量默认都是 字符串 ！</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs bash">var1=123<br>var2=hello<br>var3=<span class="hljs-string">&quot;hello_quote&quot;</span><br>var4=<span class="hljs-string">&#x27;semi_quote&#x27;</span><br>var5=<span class="hljs-string">&quot;hello world 123&quot;</span><br><br><span class="hljs-built_in">echo</span> hello   <span class="hljs-comment"># hello</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;你好&quot;</span>   <span class="hljs-comment"># 你好</span><br><span class="hljs-built_in">echo</span> var2    <span class="hljs-comment"># var2</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var2</span>   <span class="hljs-comment"># hello</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var3</span>   <span class="hljs-comment"># hello_quote</span><br><span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$var4</span>&quot;</span> <span class="hljs-comment"># semi_quote</span><br></code></pre></td></tr></table></figure><h5 id="带空格的字符串也可以类似数组迭代"><a href="#带空格的字符串也可以类似数组迭代" class="headerlink" title="带空格的字符串也可以类似数组迭代"></a>带空格的字符串也可以类似数组迭代</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">arr=<span class="hljs-string">&quot;hello world arr&quot;</span><br><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-variable">$arr</span>; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h5 id="拼字符串的时候会看起来很奇怪"><a href="#拼字符串的时候会看起来很奇怪" class="headerlink" title="拼字符串的时候会看起来很奇怪"></a>拼字符串的时候会看起来很奇怪</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">var=nihao<br><span class="hljs-built_in">echo</span> \&quot;hello world\&quot; and <span class="hljs-variable">$var</span> are equal<br></code></pre></td></tr></table></figure><h5 id="数组的操作和其他语言不大一样"><a href="#数组的操作和其他语言不大一样" class="headerlink" title="数组的操作和其他语言不大一样"></a>数组的操作和其他语言不大一样</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">long=(longalong 18 <span class="hljs-string">&quot;handsome&quot;</span>)<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;long[0]&#125;</span>  <span class="hljs-variable">$&#123;long[2]&#125;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;long[*]&#125;</span> <span class="hljs-comment"># 全部</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;#long[*]&#125;</span>  <span class="hljs-comment"># 数组长度！！</span><br></code></pre></td></tr></table></figure><p>数组也可以这么赋值 <code>ages=([3]=24 [5]=19 [10]=12)</code></p><p>数组拼接方式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">array1=(23 56)<br>array2=(99 <span class="hljs-string">&quot;hello world&quot;</span>)<br>array_new=(<span class="hljs-variable">$&#123;array1[@]&#125;</span> <span class="hljs-variable">$&#123;array2[*]&#125;</span>)<br></code></pre></td></tr></table></figure><p>删除数组一个值</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">arr=(23 56 99 <span class="hljs-string">&quot;hello world&quot;</span>)<br><span class="hljs-built_in">unset</span> arr[1]<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;arr[*]&#125;</span><br></code></pre></td></tr></table></figure><h5 id="map-关联数组-需要申明，其他可申可不申"><a href="#map-关联数组-需要申明，其他可申可不申" class="headerlink" title="map (关联数组) 需要申明，其他可申可不申"></a>map (关联数组) 需要申明，其他可申可不申</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">declare</span> -A testmap<br><br>testmap[name]=longsang<br>testmap[age]=18<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;testmap[age]&#125;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;testmap[*]&#125;</span><br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs text">-f [name]	列出之前由用户在脚本中定义的函数名称和函数体。<br>-F [name]	仅列出自定义函数名称。<br>-g name	在 Shell 函数内部创建全局变量。<br>-p [name]	显示指定变量的属性和值。<br>-a name	声明变量为普通数组。<br>-A name	声明变量为关联数组（支持索引下标为字符串）。<br>-i name 	将变量定义为整数型。<br>-r name[=value] 	将变量定义为只读（不可修改和删除），等价于 readonly name。<br>-x name[=value]	将变量设置为环境变量，等价于 export name[=value]。<br></code></pre></td></tr></table></figure><h5 id="true-和-false-有时候是-bool-，有时候又是-字符串"><a href="#true-和-false-有时候是-bool-，有时候又是-字符串" class="headerlink" title="true 和 false 有时候是 bool ，有时候又是 字符串"></a>true 和 false 有时候是 bool ，有时候又是 字符串</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">vart=<span class="hljs-literal">true</span><br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$vart</span><br><br><span class="hljs-keyword">if</span> <span class="hljs-variable">$vart</span>; <span class="hljs-keyword">then</span> <span class="hljs-built_in">echo</span> hello; <span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h5 id="所有变量的直接使用都得用-xxx"><a href="#所有变量的直接使用都得用-xxx" class="headerlink" title="所有变量的直接使用都得用 $xxx"></a>所有变量的直接使用都得用 $xxx</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">name=longalong<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span><br></code></pre></td></tr></table></figure><h5 id="直接命名的变量都是全局变量-包括-function-中！！"><a href="#直接命名的变量都是全局变量-包括-function-中！！" class="headerlink" title="直接命名的变量都是全局变量 (包括 function 中！！)"></a>直接命名的变量都是全局变量 (包括 function 中！！)</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs bash">name=long<br><br><span class="hljs-function"><span class="hljs-title">changename</span></span>() &#123;<br>	name=longalong<br>&#125;<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># long</span><br>changename<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># longalong</span><br><br><br><span class="hljs-comment"># 函数内可以使用 local name 重新申明</span><br>name=long<br><br><span class="hljs-function"><span class="hljs-title">changename</span></span>() &#123;<br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># long</span><br>	<span class="hljs-built_in">local</span> name  <br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># &quot;&quot;</span><br>	name=longalong<br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># longalong</span><br>&#125;<br><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># long</span><br>changename<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$name</span>  <span class="hljs-comment"># long</span><br></code></pre></td></tr></table></figure><h5 id="大量使用子命令"><a href="#大量使用子命令" class="headerlink" title="大量使用子命令"></a>大量使用子命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">now=`date`<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$now</span><br><br>now=$(date)<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$now</span><br></code></pre></td></tr></table></figure><h5 id="类型很弱，也就别期待-结构体、类型、对象-这类东西了"><a href="#类型很弱，也就别期待-结构体、类型、对象-这类东西了" class="headerlink" title="类型很弱，也就别期待 结构体、类型、对象 这类东西了"></a>类型很弱，也就别期待 结构体、类型、对象 这类东西了</h5><h4 id="运算符差异"><a href="#运算符差异" class="headerlink" title="运算符差异"></a>运算符差异</h4><h5 id="语言层没有算数运算符！！！"><a href="#语言层没有算数运算符！！！" class="headerlink" title="语言层没有算数运算符！！！"></a>语言层没有算数运算符！！！</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">var1=123<br>var2=321<br>var3=123+321<br>var4=<span class="hljs-variable">$var1</span>+<span class="hljs-variable">$var2</span><br><br><span class="hljs-built_in">echo</span> var3 : <span class="hljs-variable">$var3</span>  <span class="hljs-comment"># var3 : 123+321</span><br><span class="hljs-built_in">echo</span> var4 : <span class="hljs-variable">$var4</span>  <span class="hljs-comment"># var4 : 123+321</span><br></code></pre></td></tr></table></figure><p>要使用指令进行计算</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">var1=123<br>var2=321<br><br><span class="hljs-comment"># 用 let 做运算</span><br><span class="hljs-built_in">let</span> var3=<span class="hljs-variable">$var1</span>+<span class="hljs-variable">$var2</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var3</span> <span class="hljs-comment"># 444</span><br><br><span class="hljs-comment"># 用 $(()) 做运算</span><br>var4=$((<span class="hljs-variable">$var1</span> + <span class="hljs-variable">$var2</span>))<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var4</span> <span class="hljs-comment"># 444</span><br></code></pre></td></tr></table></figure><p>或者使用单独的命令来实现</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">var1=123<br>var2=321<br><br>var3=`expr <span class="hljs-variable">$var1</span> + <span class="hljs-variable">$var2</span>`<br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$var3</span><br></code></pre></td></tr></table></figure><p><strong>需要注意的是：</strong></p><p>以上方法都仅适用于 <code>整数运算</code> ，要想做浮点运算，需要用 <code>bc</code> 或者 <code>awk</code> ！</p><h5 id="关系运算符-比较运算符-的样式很怪异"><a href="#关系运算符-比较运算符-的样式很怪异" class="headerlink" title="关系运算符(比较运算符) 的样式很怪异"></a>关系运算符(比较运算符) 的样式很怪异</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=123<br>b=123<br><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -eq <span class="hljs-variable">$b</span> ]<br><span class="hljs-keyword">then</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span> -eq <span class="hljs-variable">$b</span> : a 等于 b&quot;</span><br><span class="hljs-keyword">else</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span> -eq <span class="hljs-variable">$b</span>: a 不等于 b&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>当然也可以用 &gt; 、&lt; 、 &gt;= 这种</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=124<br>b=123<br><br><span class="hljs-keyword">if</span> (( <span class="hljs-variable">$a</span> &gt;= <span class="hljs-variable">$b</span> ))<br><span class="hljs-keyword">then</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span> &gt;= <span class="hljs-variable">$b</span> : a 大于等于 b&quot;</span><br><span class="hljs-keyword">else</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-string">&quot;<span class="hljs-variable">$a</span> &lt; <span class="hljs-variable">$b</span>: a 小于 b&quot;</span><br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><p>需要注意的是， = 这个符号，在比较中，代表的是 “等于”，而不是赋值。</p><h5 id="逻辑运算-amp-amp-和布尔运算含义是一样的，但布尔运算形式和关系运算符类似"><a href="#逻辑运算-amp-amp-和布尔运算含义是一样的，但布尔运算形式和关系运算符类似" class="headerlink" title="逻辑运算 &amp;&amp; || 和布尔运算含义是一样的，但布尔运算形式和关系运算符类似"></a>逻辑运算 &amp;&amp; || 和布尔运算含义是一样的，但布尔运算形式和关系运算符类似</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=<span class="hljs-literal">false</span><br>b=<span class="hljs-literal">true</span><br><span class="hljs-keyword">if</span> [ <span class="hljs-variable">$a</span> -o <span class="hljs-variable">$b</span> ]; <span class="hljs-keyword">then</span><br>	<span class="hljs-built_in">echo</span> a or b<br><span class="hljs-keyword">fi</span><br></code></pre></td></tr></table></figure><h5 id="看起来很不习惯的字符串运算符"><a href="#看起来很不习惯的字符串运算符" class="headerlink" title="看起来很不习惯的字符串运算符"></a>看起来很不习惯的字符串运算符</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs text">假设  a=abc  b=def<br><br>=	检测两个字符串是否相等，相等返回 true。	[ $a = $b ] 返回 false。<br>!=	检测两个字符串是否不相等，不相等返回 true。	[ $a != $b ] 返回 true。<br>-z	检测字符串长度是否为0，为0返回 true。	[ -z $a ] 返回 false。<br>-n	检测字符串长度是否不为 0，不为 0 返回 true。	[ -n &quot;$a&quot; ] 返回 true。<br>$	检测字符串是否不为空，不为空返回 true。	[ $a ] 返回 true。<br></code></pre></td></tr></table></figure><h5 id="有文件运算符这种东西"><a href="#有文件运算符这种东西" class="headerlink" title="有文件运算符这种东西"></a>有文件运算符这种东西</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs text">文件类型判断<br>-b filename	判断文件是否存在，并且是否为块设备文件。<br>-c filename	判断文件是否存在，并且是否为字符设备文件。<br>-d filename	判断文件是否存在，并且是否为目录文件。<br>-e filename	判断文件是否存在。<br>-f filename	判断文件是否存在，井且是否为普通文件。<br>-L filename	判断文件是否存在，并且是否为符号链接文件。<br>-p filename	判断文件是否存在，并且是否为管道文件。<br>-s filename	判断文件是否存在，并且是否为非空。<br>-S filename	判断该文件是否存在，并且是否为套接字文件。<br><br>文件权限判断<br>-r filename	判断文件是否存在，并且是否拥有读权限。<br>-w filename	判断文件是否存在，并且是否拥有写权限。<br>-x filename	判断文件是否存在，并且是否拥有执行权限。<br>-u filename	判断文件是否存在，并且是否拥有 SUID 权限。<br>-g filename	判断文件是否存在，并且是否拥有 SGID 权限。<br>-k filename	判断该文件是否存在，并且是否拥有 SBIT 权限。<br><br>文件比较<br>filename1 -nt filename2	判断 filename1 的修改时间是否比 filename2 的新。<br>filename -ot filename2	判断 filename1 的修改时间是否比 filename2 的旧。<br>filename1 -ef filename2	判断 filename1 是否和 filename2 的 inode 号一致，可以理解为两个文件是否为同一个文件。这个判断用于判断硬链接是很好的方法<br></code></pre></td></tr></table></figure><h4 id="作用域分隔符的差异"><a href="#作用域分隔符的差异" class="headerlink" title="作用域分隔符的差异"></a>作用域分隔符的差异</h4><p>使用反过来的方式表示结束，和大多数用 <code>&#123;&#125;</code> 或者用 缩进 做区分的方式不同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs text">if 和 fi<br>do 和 done<br>case 和 esac<br></code></pre></td></tr></table></figure><h4 id="函数调用方法的差异"><a href="#函数调用方法的差异" class="headerlink" title="函数调用方法的差异"></a>函数调用方法的差异</h4><ul><li>调用不用加小括号</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">sayhello</span></span>() &#123;<br>	<span class="hljs-built_in">echo</span> hello<br>&#125;<br><br>sayhello<br></code></pre></td></tr></table></figure><ul><li>参数直接跟在调用的后面</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">greet</span></span>() &#123;<br>	<span class="hljs-built_in">echo</span> hello <span class="hljs-variable">$1</span>, welcome<br>&#125;<br><br>greet longalong<br></code></pre></td></tr></table></figure><ul><li>没有形参进行接收，全部用位置表示，且从 1 开始计数</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">sayit</span></span>() &#123;<br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$1</span> <span class="hljs-variable">$2</span> <span class="hljs-variable">$3</span> <span class="hljs-variable">$4</span> <span class="hljs-variable">$5</span><br>	<span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;11&#125;</span> <span class="hljs-comment"># 超过 10 以上</span><br>	<span class="hljs-built_in">echo</span> 参数总数为 : <span class="hljs-variable">$#</span><br>	<span class="hljs-built_in">echo</span> 所有参数为 : $*<br>&#125;<br><br>sayit longalong IS VERY HANDSOME<br></code></pre></td></tr></table></figure><ul><li>return 仅返回 0-255 的数字，一般表示运行情况，而真正想要被变量接收的，则用 echo 实现</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-function"><span class="hljs-title">whatisreturn</span></span>() &#123;<br>	<span class="hljs-built_in">echo</span> hello<br>	<span class="hljs-built_in">echo</span> world<br>	<span class="hljs-built_in">return</span><br>&#125;<br><br>re=`whatisreturn`<br><br><span class="hljs-built_in">echo</span> $?   <span class="hljs-comment"># 0</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$re</span>  <span class="hljs-comment"># hello world</span><br></code></pre></td></tr></table></figure><h4 id="for-循环的差异"><a href="#for-循环的差异" class="headerlink" title="for 循环的差异"></a>for 循环的差异</h4><p>有一些和其他语言不一样的地方</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> (( i=0;i&lt;=5;i++ )); <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> &#123;0..5&#125;; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `seq 0 5`; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> `cat xxx`; <span class="hljs-keyword">do</span> <span class="hljs-built_in">echo</span> <span class="hljs-variable">$i</span>; <span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs bash">int=1<br><span class="hljs-keyword">while</span>(( <span class="hljs-variable">$int</span>&lt;=5 ))<br><span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$int</span><br>    <span class="hljs-built_in">let</span> <span class="hljs-string">&quot;int++&quot;</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">a=0<br><br>until [ ! <span class="hljs-variable">$a</span> -lt 10 ]<br><span class="hljs-keyword">do</span><br>   <span class="hljs-built_in">echo</span> <span class="hljs-variable">$a</span><br>   a=`expr <span class="hljs-variable">$a</span> + 1`<br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-keyword">for</span> filename <span class="hljs-keyword">in</span> *.sh<br><span class="hljs-keyword">do</span><br>    <span class="hljs-built_in">echo</span> <span class="hljs-variable">$filename</span><br><span class="hljs-keyword">done</span><br></code></pre></td></tr></table></figure><h4 id="分支语句的差异"><a href="#分支语句的差异" class="headerlink" title="分支语句的差异"></a>分支语句的差异</h4><ul><li><p>if 语句的差别主要在关系运算符上</p></li><li><p>多分支语句</p></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs bash">num=<span class="hljs-variable">$1</span><br><br><span class="hljs-keyword">case</span> <span class="hljs-variable">$aNum</span> <span class="hljs-keyword">in</span><br>    1)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;你输入了 1&#x27;</span><br>    ;;<br>    2)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;你输入了 2&#x27;</span><br>    ;;<br>    *)  <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;你没有输入 1 和 2&#x27;</span><br>    ;;<br><span class="hljs-keyword">esac</span><br></code></pre></td></tr></table></figure><h4 id="文本处理的差异"><a href="#文本处理的差异" class="headerlink" title="文本处理的差异"></a>文本处理的差异</h4><ul><li>字符串操作</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">str=<span class="hljs-string">&quot;hello world&quot;</span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;#str&#125;</span>  <span class="hljs-comment"># 井号取长度，和 arr 一样，大多数语言会用函数如 len() 或者属性如 .length </span><br><span class="hljs-built_in">echo</span> <span class="hljs-variable">$&#123;str:2:-2&#125;</span> <span class="hljs-comment"># 冒号为截取子串，大多数语言会用中括号加冒号，如 str[2:-2]</span><br></code></pre></td></tr></table></figure><ul><li>更多不好记的处理方式可以参考 <a target="_blank" rel="noopener" href="http://c.biancheng.net/view/1120.html">C语言网教程</a></li></ul><h4 id="其他难理解的地方"><a href="#其他难理解的地方" class="headerlink" title="其他难理解的地方"></a>其他难理解的地方</h4><ul><li><p>在 shell 交互式命令行中经常需要转义，有些转义很难理解</p></li><li><p>有很多内建命令，具体参考 <a target="_blank" rel="noopener" href="http://c.biancheng.net/view/1136.html">C语言网教程</a></p></li><li><p>一些场景下不允许空格，一些场景下又必须空格</p></li><li><p>多种重定向易蒙圈</p></li><li><p>几乎没有模块系统</p></li></ul><p>可以过一遍<a target="_blank" rel="noopener" href="https://www.runoob.com/linux/linux-shell-process-control.html">菜鸟</a><br>可以看下<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/102176365/">一个同事写的</a><br><a target="_blank" rel="noopener" href="http://c.biancheng.net/view/942.html">C语言网教程</a> 的高级部分还是值得看一下，但要付费，姑且按照相关话题，在网上搜搜资料。</p><h2 id="ansible"><a href="#ansible" class="headerlink" title="ansible"></a>ansible</h2><p>先把 <a target="_blank" rel="noopener" href="https://docs.ansible.com/">官方文档</a> 看一遍<br>然后把 <a target="_blank" rel="noopener" href="https://github.com/geerlingguy/ansible-for-devops">ansible-for-devops</a> 里面的案例看一遍，这个项目的作者专门在搞 ansible，可以看 <a target="_blank" rel="noopener" href="https://github.com/geerlingguy?tab=repositories">他的主页</a></p><h3 id="基本理解"><a href="#基本理解" class="headerlink" title="基本理解"></a>基本理解</h3><ul><li><p>ansible 是一个 linux 批处理任务工具，通过提供 分类、批量、顺序、选择、触发 等编排能力，实现远程任务管理能力。</p></li><li><p>ansible 主要用来做 基础设施准备 (配置管理+置备)、 服务CICD (部署自动化)、任务编排 (构建存储系统、构建集群等等)。</p></li><li><p>ansible 命令方式执行，类似于在多台机器上执行命令。(和 iterm 中使用 cmd + alt + i 类似)</p></li><li><p>最强大的地方在于其生态，可以从 <a target="_blank" rel="noopener" href="https://galaxy.ansible.com/">https://galaxy.ansible.com/</a> 找到大量别人写好的 roles 、plugins 等等，可以很简便就集成使用。 实际上，和使用 docker-compose 起服务、使用 helm charts 起服务 一样，都可以在他人成果的基础上使用。</p></li></ul><h3 id="官方文档阅读笔记"><a href="#官方文档阅读笔记" class="headerlink" title="官方文档阅读笔记"></a>官方文档阅读笔记</h3><ul><li><p>ansible 使用 ini 文件 或者 yaml 文件 作为配置文件格式</p></li><li><p>inventory ： 用来标识要管理的机器，对机器进行 分组、配置连接方式(user、jump等)、动态监控云上机器并自动修改要管理的机器实例等。 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html">官方文档</a></p></li><li><p>playbook： 用来描述一系列任务的方式，分为 角色(role: 不同的系列任务)、任务(tasks: 一系列任务)，这是大多数项目使用 ansible 的方式。 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_reuse_roles.html">roles</a> <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html">主要概念</a></p></li><li><p>templates: 用来动态生成 yaml/ini 配置文件的模板，使用 jinja2 (python)。<a target="_blank" rel="noopener" href="https://jinja.palletsprojects.com/en/3.1.x/templates/#builtin-filters">jinja文档</a> <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#playbooks-variables">ansible 中的变量</a> <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_vars_facts.html#vars-and-facts">ansible 中特定的变量</a> [重要]</p></li><li><p>module： 模块，ansible 的要执行的各种功能是以模块呈现的，例如 copy、创建文件 等等，不同的模块有不同的参数，ansible 的各种 tasks (实际执行的任务)，都是用 模块 + 参数 的方式构成的。 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/index.html#description">ansible 的默认模块</a> [重要]</p></li><li><p>ansible 的概念结构可以参考 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/dev_guide/overview_architecture.html#modules">ansible architecture</a> [重要]</p></li><li><p>playbook 是一个 任务编排 工具，抽象来看，市面上有非常多的任务编排系统，他们所面对的问题域基本都是一样的，可以以此为例子对任务编排进行梳理。</p><ul><li><input disabled type="checkbox"> 调研多种任务编排系统，找到他们的共性问题</li></ul></li></ul><h3 id="简单试用"><a href="#简单试用" class="headerlink" title="简单试用"></a>简单试用</h3><ul><li><p>安装 ansible</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">yum install -y ansible<br></code></pre></td></tr></table></figure></li><li><p>设置要管理的机器 (inventory)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs text">vim /etc/ansible/hosts<br><br>[chaos]<br>172.17.5.245<br>172.17.5.246<br>172.17.5.247<br></code></pre></td></tr></table></figure></li><li><p>使用 shell 查看信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs text">ansible chaos -m shell -a &quot;uname -a&quot;<br><br>172.17.5.245 | CHANGED | rc=0 &gt;&gt;<br>Linux prichaos003 3.10.0-1127.19.1.el7.x86_64 #1 SMP Tue Aug 25 17:23:54 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux<br>172.17.5.247 | CHANGED | rc=0 &gt;&gt;<br>Linux prichaos002 3.10.0-1127.19.1.el7.x86_64 #1 SMP Tue Aug 25 17:23:54 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux<br>172.17.5.246 | CHANGED | rc=0 &gt;&gt;<br>Linux prichaos001 3.10.0-1127.19.1.el7.x86_64 #1 SMP Tue Aug 25 17:23:54 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux<br></code></pre></td></tr></table></figure></li></ul><h3 id="mac-下的使用"><a href="#mac-下的使用" class="headerlink" title="mac 下的使用"></a>mac 下的使用</h3><h4 id="安装-ansible"><a href="#安装-ansible" class="headerlink" title="安装 ansible"></a>安装 ansible</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 如果报错 No such file or directory @ xxx, </span><br><span class="hljs-comment"># 大概率是因为设置了国内源，这是由于国内源没有同步某些包，要不再换个源，要不就：</span><br><span class="hljs-comment"># export HOMEBREW_BOTTLE_DOMAIN=&#x27;&#x27;</span><br><br>brew install ansible<br><br><span class="hljs-comment"># pip install ansible</span><br></code></pre></td></tr></table></figure><h4 id="基本文件"><a href="#基本文件" class="headerlink" title="基本文件"></a>基本文件</h4><h5 id="config-file"><a href="#config-file" class="headerlink" title="config file"></a>config file</h5><p>这是 ansible 的配置文件，会按照 $ANSIBLE_CFG、./ansible.cfg、~/.ansible.cfg、/etc/ansible/ansible.cfg 几个路径搜寻。</p><p>用来配置 ansible 的默认行为。常用的配置说明可以参考 <a target="_blank" rel="noopener" href="https://blog.csdn.net/vipygd/article/details/101868144">ansible.cfg常用配置</a></p><p>也可以查看 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html">官方文档</a></p><p>我的一个简单的配置长这样：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs text">[defaults]<br>remote_port = 22<br>remote_user = root<br>forks = 10<br>retry_files_save_path = /tmp/.ansible-retry<br><br>host_key_checking = False<br>deprecation_warnings = False<br>command_warnings = False<br>gathering = smart<br><br>inventory = inventory/hosts<br></code></pre></td></tr></table></figure><h5 id="inventory"><a href="#inventory" class="headerlink" title="inventory"></a>inventory</h5><p>这是要被管理的机器的配置，主要是 host 和连接方式的配置。<br>文件大概长这样：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><code class="hljs text">[nfs]<br>10.10.10.4<br><br>[server_init]<br><br>[server]<br>10.10.10.5 ansible_ssh_user=root<br><br>[agent]<br>10.10.10.6<br>10.10.10.7<br><br>[remove_server]<br>10.10.10.5<br><br>[remove_agent]<br>10.10.10.6<br>10.10.10.7<br><br>[k3s:children]<br>server_init<br>server<br>agent<br><br></code></pre></td></tr></table></figure><p>更多用法可以查看 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html">官方文档</a></p><h4 id="简单使用"><a href="#简单使用" class="headerlink" title="简单使用"></a>简单使用</h4><ul><li><p>执行一个简单的 shell 命令</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">ansible nfs  -m shell -a <span class="hljs-string">&#x27;uptime&#x27;</span><br><span class="hljs-comment"># 10.10.10.4 | CHANGED | rc=0 &gt;&gt;</span><br><span class="hljs-comment"># 11:57:12 up 418 days, 13:03,  1 user,  load average: 0.04, 0.04,  0.05</span><br></code></pre></td></tr></table></figure></li><li><p>打开调试</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-comment"># 调试常用 debug 模块，可以定向打印出一些信息，自己学习的时候可以看更多的信息，用 -v 或 -vvv 打开 ansible 的日志。</span><br><br>ansible all  -m shell -a <span class="hljs-string">&#x27;uptime&#x27;</span> -vvv<br><br><span class="hljs-comment"># 一大堆信息，可以用于帮助理解 ansible 究竟干了啥</span><br></code></pre></td></tr></table></figure></li></ul><h4 id="调试一下-template"><a href="#调试一下-template" class="headerlink" title="调试一下 template"></a>调试一下 template</h4><p>ansible 的 template 在 playbook 下使用，极大扩展了 ansible 的灵活性，有啥是一个模板解决不了的呢？毕竟模板意味着编程能力。</p><p>tempalte 使用的是 python 的 jinja2 作为模板语言。就开发而言，用模板生成内容有两种模式，通过编程拼接模板 和 在模板中编程，毫无疑问，ansible 是 在模板中编程 的路子。</p><p>template 需要两个主题： 模板、变量。</p><p>变量的来源在 ansible 中比较多，主要分为两类： 内置变量、用户生成变量。<br>变量的使用主要有两个方面： tempalte 中， task 的逻辑语句中。</p><ul><li><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html">特殊变量官方文档</a></li><li><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html">普通变量使用官方文档</a></li></ul><p>用户生成变量的地方主要有这么几个： <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html#understanding-variable-precedence">参考官方文档</a></p><ul><li>在特定文件中生成，例如 inventory 文件、playbook文件、role文件等。</li><li>在命令行中传入 <code>--extra-vars xx=xxx xx2=xxxx</code> (简写为 <code>-e</code>)</li></ul><p>具体可以查看 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/special_variables.html#where-to-set-variables">变量使用官方文档</a></p><p>写 ansible 的 playbook 需要两方面的核心知识：</p><ul><li>理解具体的业务逻辑，这样才能抽象出合适的 role</li><li>理解 ansible 的运行逻辑，主要包括 各配置文件及字段含义 ( <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/config.html">config字段</a> 、<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/reference_appendices/playbooks_keywords.html">palybook的字段</a>、 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/inventory_guide/intro_inventory.html">inventory字段</a>)、<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/playbook_guide/playbooks_variables.html">变量</a>、<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/all_plugins.html">plugin</a> (plugin极其重要，以后写配置时经常去里面查询各种字段含义)</li></ul><p>需要注意的是，ansible 新版本在 plugin/module 的使用上和之前 2.9 的版本有一些差别，主要是没有命名空间的概念，例如，都是使用 file 模块(管理远端文件及文件夹)，现在的版本是<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html#ansible-collections-ansible-builtin-file-module">这样写</a>：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Create</span> <span class="hljs-string">a</span> <span class="hljs-string">directory</span> <span class="hljs-string">if</span> <span class="hljs-string">it</span> <span class="hljs-string">does</span> <span class="hljs-string">not</span> <span class="hljs-string">exist</span><br>  <span class="hljs-attr">ansible.builtin.file:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">/etc/some_directory</span><br>    <span class="hljs-attr">state:</span> <span class="hljs-string">directory</span><br>    <span class="hljs-attr">mode:</span> <span class="hljs-string">&#x27;0755&#x27;</span><br></code></pre></td></tr></table></figure><p>而 2.9 的版本是<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/2.9/modules/file_module.html#examples">这样写</a>：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">Create</span> <span class="hljs-string">a</span> <span class="hljs-string">directory</span> <span class="hljs-string">if</span> <span class="hljs-string">it</span> <span class="hljs-string">does</span> <span class="hljs-string">not</span> <span class="hljs-string">exist</span><br>  <span class="hljs-attr">file:</span><br>    <span class="hljs-attr">path:</span> <span class="hljs-string">/etc/some_directory</span><br>    <span class="hljs-attr">state:</span> <span class="hljs-string">directory</span><br>    <span class="hljs-attr">mode:</span> <span class="hljs-string">&#x27;0755&#x27;</span><br></code></pre></td></tr></table></figure><p>看到这样的写法，找不到对应的字段说明先不要慌张，说明是 2.9 之前的版本，具体可以查看 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/2.9/modules/list_of_files_modules.html">module index</a></p><p>为了简单调试，我们直接使用 命令行传入。;</p><p>使用了 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html#ansible-collections-ansible-builtin-template-module">template</a>、 <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html#examples">copy</a>、<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/shell_module.html#examples">shell</a></p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ping</span> <span class="hljs-string">test</span> <span class="hljs-string">send</span> <span class="hljs-string">files</span><br>  <span class="hljs-attr">ansible.builtin.copy:</span><br>    <span class="hljs-attr">src:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; item.src &#125;&#125;</span>&quot;</span><br>    <span class="hljs-attr">dest:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; item.dest &#125;&#125;</span>&quot;</span><br>    <span class="hljs-attr">mode:</span> <span class="hljs-string">&quot;<span class="hljs-template-variable">&#123;&#123; item.mode &#125;&#125;</span>&quot;</span><br>  <span class="hljs-attr">with_items:</span><br>  <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">src:</span> <span class="hljs-string">&quot;test.sh&quot;</span>, <span class="hljs-attr">dest:</span> <span class="hljs-string">&quot;/tmp/longtest/test.sh&quot;</span> ,<span class="hljs-attr">mode:</span> <span class="hljs-string">&quot;0755&quot;</span> &#125;<br>  <span class="hljs-bullet">-</span> &#123; <span class="hljs-attr">src:</span> <span class="hljs-string">&quot;hello.txt&quot;</span>, <span class="hljs-attr">dest:</span> <span class="hljs-string">&quot;/tmp/longtest/hello.txt&quot;</span> ,<span class="hljs-attr">mode:</span> <span class="hljs-string">&quot;0644&quot;</span> &#125;<br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ping</span> <span class="hljs-string">test</span> <span class="hljs-string">cat</span> <span class="hljs-string">run</span><br>  <span class="hljs-attr">ansible.builtin.shell:</span><br>    <span class="hljs-attr">cmd:</span> <span class="hljs-string">cat</span> <span class="hljs-string">/tmp/longtest/hello.txt</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ping</span> <span class="hljs-string">test</span> <span class="hljs-string">sh</span> <span class="hljs-string">run</span><br>  <span class="hljs-attr">ansible.builtin.shell:</span><br>    <span class="hljs-attr">cmd:</span> <span class="hljs-string">sh</span> <span class="hljs-string">/tmp/longtest/test.sh</span><br><br><span class="hljs-bullet">-</span> <span class="hljs-attr">name:</span> <span class="hljs-string">ping</span> <span class="hljs-string">test</span> <span class="hljs-string">template</span> <span class="hljs-string">send</span> <span class="hljs-string">files</span><br>  <span class="hljs-attr">ansible.builtin.template:</span><br>    <span class="hljs-attr">src:</span> <span class="hljs-string">pingpong.yaml.j2</span><br>    <span class="hljs-attr">dest:</span> <span class="hljs-string">&quot;/tmp/longtest/pingpong.yaml&quot;</span><br>    <span class="hljs-attr">mode:</span> <span class="hljs-number">0640</span><br></code></pre></td></tr></table></figure><p>以下是 templates/pingpong.yaml.j2 的一部分内容：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs yaml"><span class="hljs-meta">---</span><br><span class="hljs-attr">apiVersion:</span> <span class="hljs-string">v1</span><br><span class="hljs-attr">kind:</span> <span class="hljs-string">ConfigMap</span><br><span class="hljs-attr">metadata:</span><br>  <span class="hljs-attr">name:</span> <span class="hljs-string">pingpong</span><br>  <span class="hljs-attr">namespace:</span> <span class="hljs-string">kube-system</span><br><span class="hljs-attr">data:</span><br>  <span class="hljs-attr">config.yaml:</span> <span class="hljs-string">|-</span><br><span class="hljs-string">    app_name: &quot;pingpong&quot;</span><br><span class="hljs-string">    server:</span><br><span class="hljs-string">      port: 8080</span><br><span class="hljs-string">    log:</span><br><span class="hljs-string">      level: &quot;info&quot;</span><br><span class="hljs-string">    companyName: &quot;longtest&quot;</span><br><span class="hljs-string">    ping:</span><br><span class="hljs-string">      Enable: &#123;&#123;EXT_PINGPONG_ENABLE&#125;&#125;</span><br><span class="hljs-string">      CronPattern: &quot;0 */2 * * * *&quot;</span><br><span class="hljs-string">      Host: &quot;&quot;</span><br><span class="hljs-string">      Auth:</span><br><span class="hljs-string">        Enable: false</span><br></code></pre></td></tr></table></figure><p>运行以下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">ansible-playbook -e <span class="hljs-string">&#x27;EXT_GLOBAL_DOMAIN=https://longalong.cn EXT_PINGPONG_ENABLE=true&#x27;</span> ping.yaml  -vv<br></code></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs text">PLAYBOOK: ping.yaml **************************************************************************************************************************************************************************<br>1 plays in ping.yaml<br><br>PLAY [server] ********************************************************************************************************************************************************************************<br><br>TASK [Gathering Facts] ***********************************************************************************************************************************************************************<br>task path: /Users/andyhu/code/mastergo-deployer/dockerfile/ping.yaml:2<br>ok: [101.42.240.235]<br><br>TASK [ping : ping test send files] ***********************************************************************************************************************************************************<br>task path: /Users/andyhu/code/mastergo-deployer/dockerfile/roles/ping/tasks/main.yaml:2<br>ok: [101.42.240.235] =&gt; (item=&#123;&#x27;src&#x27;: &#x27;test.sh&#x27;, &#x27;dest&#x27;: &#x27;/tmp/longtest/test.sh&#x27;, &#x27;mode&#x27;: &#x27;0755&#x27;&#125;) =&gt; &#123;&quot;ansible_loop_var&quot;: &quot;item&quot;, &quot;changed&quot;: false, &quot;checksum&quot;: &quot;fd4ef272800af37c1e5a82235c4f1fdf35d10cfb&quot;, &quot;dest&quot;: &quot;/tmp/longtest/test.sh&quot;, &quot;gid&quot;: 0, &quot;group&quot;: &quot;root&quot;, &quot;item&quot;: &#123;&quot;dest&quot;: &quot;/tmp/longtest/test.sh&quot;, &quot;mode&quot;: &quot;0755&quot;, &quot;src&quot;: &quot;test.sh&quot;&#125;, &quot;mode&quot;: &quot;0755&quot;, &quot;owner&quot;: &quot;root&quot;, &quot;path&quot;: &quot;/tmp/longtest/test.sh&quot;, &quot;size&quot;: 71, &quot;state&quot;: &quot;file&quot;, &quot;uid&quot;: 0&#125;<br><br><br>ok: [101.42.240.235] =&gt; (item=&#123;&#x27;src&#x27;: &#x27;hello.txt&#x27;, &#x27;dest&#x27;: &#x27;/tmp/longtest/hello.txt&#x27;, &#x27;mode&#x27;: &#x27;0644&#x27;&#125;) =&gt; &#123;&quot;ansible_loop_var&quot;: &quot;item&quot;, &quot;changed&quot;: false, &quot;checksum&quot;: &quot;2aae6c35c94fcfb415dbe95f408b9ce91ee846ed&quot;, &quot;dest&quot;: &quot;/tmp/longtest/hello.txt&quot;, &quot;gid&quot;: 0, &quot;group&quot;: &quot;root&quot;, &quot;item&quot;: &#123;&quot;dest&quot;: &quot;/tmp/longtest/hello.txt&quot;, &quot;mode&quot;: &quot;0644&quot;, &quot;src&quot;: &quot;hello.txt&quot;&#125;, &quot;mode&quot;: &quot;0644&quot;, &quot;owner&quot;: &quot;root&quot;, &quot;path&quot;: &quot;/tmp/longtest/hello.txt&quot;, &quot;size&quot;: 11, &quot;state&quot;: &quot;file&quot;, &quot;uid&quot;: 0&#125;<br><br>TASK [ping : ping test cat run] **************************************************************************************************************************************************************<br>task path: /Users/andyhu/code/mastergo-deployer/dockerfile/roles/ping/tasks/main.yaml:11<br><br><br>changed: [101.42.240.235] =&gt; &#123;&quot;changed&quot;: true, &quot;cmd&quot;: &quot;cat /tmp/longtest/hello.txt&quot;, &quot;delta&quot;: &quot;0:00:00.053376&quot;, &quot;end&quot;: &quot;2023-02-15 15:01:48.824142&quot;, &quot;msg&quot;: &quot;&quot;, &quot;rc&quot;: 0, &quot;start&quot;: &quot;2023-02-15 15:01:48.770766&quot;, &quot;stderr&quot;: &quot;&quot;, &quot;stderr_lines&quot;: [], &quot;stdout&quot;: &quot;hello world&quot;, &quot;stdout_lines&quot;: [&quot;hello world&quot;]&#125;<br><br>TASK [ping : ping test sh run] ***************************************************************************************************************************************************************<br>task path: /Users/andyhu/code/mastergo-deployer/dockerfile/roles/ping/tasks/main.yaml:15<br>changed: [101.42.240.235] =&gt; &#123;&quot;changed&quot;: true, &quot;cmd&quot;: &quot;sh /tmp/longtest/test.sh&quot;, &quot;delta&quot;: &quot;0:00:00.055170&quot;, &quot;end&quot;: &quot;2023-02-15 15:01:51.329984&quot;, &quot;msg&quot;: &quot;&quot;, &quot;rc&quot;: 0, &quot;start&quot;: &quot;2023-02-15 15:01:51.274814&quot;, &quot;stderr&quot;: &quot;&quot;, &quot;stderr_lines&quot;: [], &quot;stdout&quot;: &quot;hi there, i am an ansible test now is 2023年 02月 15日 星期三 15:01:51 CST&quot;, &quot;stdout_lines&quot;: [&quot;hi there, i am an ansible test now is 2023年 02月 15日 星期三 15:01:51 CST&quot;]&#125;<br><br>TASK [ping : ping test template send files] **************************************************************************************************************************************************<br>task path: /Users/andyhu/code/mastergo-deployer/dockerfile/roles/ping/tasks/main.yaml:19<br>changed: [101.42.240.235] =&gt; &#123;&quot;changed&quot;: true, &quot;checksum&quot;: &quot;c6f37e5b898f9bcd1033afe74751741eee722ab0&quot;, &quot;dest&quot;: &quot;/tmp/longtest/pingpong.yaml&quot;, &quot;gid&quot;: 0, &quot;group&quot;: &quot;root&quot;, &quot;md5sum&quot;: &quot;50ad443f786f2ff265c5f967710a1103&quot;, &quot;mode&quot;: &quot;0640&quot;, &quot;owner&quot;: &quot;root&quot;, &quot;size&quot;: 2755, &quot;src&quot;: &quot;/root/.ansible/tmp/ansible-tmp-1676444511.604792-82491-153536252047673/source&quot;, &quot;state&quot;: &quot;file&quot;, &quot;uid&quot;: 0&#125;<br><br>PLAY RECAP ***********************************************************************************************************************************************************************************<br>101.42.240.235             : ok=5    changed=3    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0 <br></code></pre></td></tr></table></figure><h3 id="可视化管理工具-awx"><a href="#可视化管理工具-awx" class="headerlink" title="可视化管理工具 awx"></a>可视化管理工具 awx</h3><p>awx 是 ansible 的可视化管理工具，是 tower 的开源版。</p><p>不得不说，awx 的文档真的是有点……</p><p>还没跑通，回头再看下吧</p><p><a target="_blank" rel="noopener" href="https://github.com/ansible/awx">awx github 地址</a></p><h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><ul><li>这篇文章可以看一下： <a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/tips_tricks/ansible_tips_tricks.html#playbook-tips">playbook-tips</a></li></ul><hr><blockquote><p>Don’t turn away from possible futures before you’re certain you don’t have anything to learn from them.<br>— <cite>Richard Bach</cite></p></blockquote></div><hr><div><div class="post-metas mb-3"><div class="post-meta"><i class="iconfont icon-tags"></i> <a class="hover-with-bg" href="/longblog/tags/linux/">linux</a> <a class="hover-with-bg" href="/longblog/tags/shell/">shell</a> <a class="hover-with-bg" href="/longblog/tags/batch/">batch</a> <a class="hover-with-bg" href="/longblog/tags/ansible/">ansible</a> <a class="hover-with-bg" href="/longblog/tags/%E6%89%B9%E4%BB%BB%E5%8A%A1/">批任务</a> <a class="hover-with-bg" href="/longblog/tags/%E6%89%B9%E5%A4%84%E7%90%86/">批处理</a></div></div><p class="note note-warning">本博客所有文章除特别声明外，均采用 <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 协议</a> ，转载请注明出处！</p><div class="post-prevnext"><article class="post-prev col-6"><a href="/longblog/posts/22_11_24_12_38_kinds_of_daemon.html"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">几种常见的daemon方式</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"><a href="/longblog/posts/22_11_22_00_15_normal_helm_charts.html"><span class="hidden-mobile">常规的charts编写方式</span> <span class="visible-mobile">下一篇</span> <i class="iconfont icon-arrowright"></i></a></article></div></div></article></div></div></div><div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;目录</p><div class="toc-body" id="toc-body"></div></div></div></div></div><a id="scroll-top-button" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer class="text-center mt-5 py-3"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div><div class="beian"><span><a href="http://beian.miit.gov.cn/" target="_blank" rel="nofollow noopener">备案: 粤ICP备2020131301号</a></span></div></footer><script src="https://static.longalong.cn/packages/blog/nprogress.min.js"></script><link rel="stylesheet" href="https://static.longalong.cn/packages/blog/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://static.longalong.cn/packages/blog/jquery.min.js"></script><script src="https://static.longalong.cn/packages/blog/js/bootstrap.min.js"></script><script src="/longblog/js/events.js"></script><script src="/longblog/js/plugins.js"></script><script src="/longblog/js/img-lazyload.js"></script><script src="https://static.longalong.cn/packages/blog/tocbot.min.js"></script><script src="https://static.longalong.cn/packages/blog/jquery.fancybox.min.js"></script><script src="https://static.longalong.cn/packages/blog/anchor.min.js"></script><script defer src="https://static.longalong.cn/packages/blog/clipboard.min.js"></script><script src="/longblog/js/local-search.js"></script><script src="https://static.longalong.cn/packages/blog/typed.min.js"></script><script>!function(t,i){(0,Fluid.plugins.typing)(i.getElementById("subtitle").title)}(window,document)</script><script src="/longblog/static/js/showiframe.js"></script><script src="/longblog/js/boot.js"></script></body></html>